{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Ticket",
  "type": "object",
  "required": ["client_id", "property_id", "summary", "source", "priority"],
  "properties": {
    "ticket_number": { "type": "string", "pattern": "^TCK-[0-9]{6}$" },
    "client_id": { "type": "string", "format": "uuid" },
    "property_id": { "type": "string", "format": "uuid" },
    "unit_id": { "type": ["string", "null"], "format": "uuid" },
    "requester_contact_id": { "type": ["string", "null"], "format": "uuid" },
    "status": {
      "type": "string",
      "enum": ["new", "qualifying", "dispatching", "quotes_pending", "awaiting_approval", "scheduled", "in_progress", "awaiting_invoice", "awaiting_payment", "closed"]
    },
    "priority": {
      "type": "string",
      "enum": ["emergency", "urgent", "routine"]
    },
    "trade": {
      "type": ["string", "null"],
      "enum": [null, "plumbing", "electrical", "hvac", "general", "roofing", "appliance", "drywall", "painting", "pest", "locksmith", "landscaping"]
    },
    "summary": { "type": "string", "minLength": 1 },
    "description": { "type": ["string", "null"] },
    "photo_urls": {
      "type": ["array", "null"],
      "items": { "type": "string", "format": "uri" }
    },
    "source": {
      "type": "string",
      "enum": ["sms", "email", "web_form", "phone", "manual"]
    },
    "approved_amount": { "type": ["number", "null"] },
    "closed_reason": {
      "type": ["string", "null"],
      "enum": [null, "completed", "duplicate", "cancelled", "no_action_needed"]
    }
  }
}
